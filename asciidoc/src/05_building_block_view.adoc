ifndef::imagesdir[:imagesdir: ../images]

[[section-building-block-view]]
== Building Block View

Die Building Block View zeigt die statische Zerlegung des Systems in Bausteine sowie deren Abhängigkeiten.

=== Level 1: Whitebox Gesamtsystem (Backend)

Hier beschreiben wir die wichtigsten Teile des Systems und wie sie interagieren.

[plantuml, level1-overview, svg]
----
@startuml
component "Basket API" <<Subsystem>> as Basket
component "Quarry API" <<Subsystem>> as Quarry

Basket ..> Quarry : "nutzt (Validierung & Bestandsprüfung)"
@enduml
----

**Beschreibung der Subsysteme:**
* **Basket API:** Verwaltet den Einkaufskorb und die Logik für den Tauschprozess.
* **Quarry API:** Verwaltet die Hinkelsteine und den Zugriff auf den Steinbruch.

---

=== Level 2: Whitebox der APIs

In diesem Level zeigen wir die interne Struktur der APIs, unterteilt in logische Building Blocks (Module).

==== Basket API (Warenkorb)

Die Basket API verwaltet den Einkaufskorb. Man kann sehen, was drin ist, Sachen reinlegen, alles rauswerfen oder den Inhalt gegen einen Stein tauschen.

[plantuml, level2-basket, svg]
----
@startuml
package "Basket API" {
    [BasketController] as Controller
    [BasketService] as Service
    [BasketRepository] as Repo
}
Controller -> Service
Service -> Repo
@enduml
----

**Wichtige Schnittstellen (Interfaces):**
* `GET /api/basket`: Zeigt den Inhalt des Korbs.
* `GET /api/basket/offer`: Legt etwas in den Korb.
* `DELETE /api/basket`: Leert den Korb.
* `POST /api/basket/buy/{menhirId}`: Tauscht den Korb-Inhalt gegen den Stein mit der ID `menhirId`.

==== Quarry API (Steinbruch)

Die Quarry API verwaltet die Hinkelsteine.

[plantuml, level2-quarry, svg]
----
@startuml
package "Quarry API" {
    [QuarryController] as Controller
    [QuarryService] as Service
    [QuarryRepository] as Repo
}
Controller -> Service
Service -> Repo
@enduml
----

**Schnittstellen:**
* `GET /api/menhirs`: Zeigt alle Steine.
* `GET /api/menhirs/{menhirId}`: Zeigt einen bestimmten Stein.
* `POST /api/menhirs`: Erstellt einen neuen Stein.
* `PUT /api/menhirs/{menhirId}`: Ändert einen Stein.
* `DELETE /api/quarry/{menhirId}`: Löscht einen Stein.

---

=== Level 3: Whitebox Datenstrukturen

Hier werden die internen Bausteine (Klassen/DTOs) detailliert, die für den Datenaustausch genutzt werden.

[plantuml, level3-data, svg]
----
@startuml
class BasketDto {
    +List<BasketItem> items
}
class BasketItem {
    +String name
    +Integer amount
}
class MenhirDto {
    +Long menhirId
    +String name
}
BasketDto "1" *-- "*" BasketItem
@enduml
----

**Wichtige Datenobjekte:**
* **BasketDto:** Der Korb mit einer Liste von Sachen.
* **BasketItem:** Ein Gegenstand im Korb (Name und Anzahl).
* **MenhirDto:** Ein Hinkelstein.
